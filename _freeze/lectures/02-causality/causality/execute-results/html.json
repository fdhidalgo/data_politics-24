{
  "hash": "f2e1f85758838a5c35f1b998c3762ac1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Causality and Introduction to `R`\"\nsubtitle: \"Lecture 2\"\ndate: last-modified\nauthor: \n  - name: F. Daniel Hidalgo\n    email: dhidalgo@mit.edu\n    affiliations: MIT\nformat: clean-revealjs\nbibliography: ../data_politics_2024.bib\neditor:\n  render-on-save: true\n---\n\n\n# What is Causality?\n\n##  {background-image=\"images/road-less-traveled-frost.jpg\" background-size=\"100%\"}\n\n::: notes\nThe Road not Taken by Robert Frost\n\nTwo roads diverged in a yellow wood, And sorry I could not travel both And be one traveler, long I stood And looked down one as far as I could To where it bent in the undergrowth;\n:::\n\n## What is a Causal Effect?\n\n-   Students with diverse friend groups express less discriminatory attitudes and are supportive of policies that promote diversity.\n    -   Would these students be supportive of these policies if they did not have diverse friend groups?\n\n. . .\n\n-   Heavy social media users are less happy on average than those who use social media less.\n    -   Is this because social media use causes unhappiness, or are unhappy people more likely to use social media?\n\n. . .\n\n::: callout-note\n## Fundamental Problem of Causal Inference\n\nWe never observe counterfactuals, they must be inferred\n:::\n\n## The Effect of Social Media\n\n::: columns\n::: {.column width=\"40%\"}\n![](images/facebook_grannies.jpg)\n:::\n\n::: {.column width=\"60%\"}\n-   Much concern about the effect of social media on:\n    -   Mental health\n    -   Political polarization\n    -   Interactions with friends and families\n:::\n:::\n\n. . .\n\nImagine two respondents:\n\n| Respondent | Social Media Use | Happiness |\n|------------|------------------|-----------|\n| 1          | High             | Low       |\n| 2          | Low              | High      |\n\n. . .\n\n[Did social media use cause the difference in happiness?]{.alert}\n\n## Some notation\n\nThe **causal** or **treatment** variable is:\n\n$$\nT_i= \\begin{cases} 1 & \\text { if respondent } i \\text { used social media } \\\\ 0 & \\text { if respondent } i \\text { did not use social media }\\end{cases}\n$$\n\nThe *observed* **outcome** variable is:\n\n$$\nY_i= \\begin{cases} 1 & \\text { if respondent } i \\text { is happy } \\\\ 0 & \\text { if respondent } i \\text { is unhappy }\\end{cases}\n$$\n\n. . .\n\nSo now, are data becomes:\n\n| Respondent | $T_i$ | $Y_i$ |\n|------------|-------|-------|\n| 1          | 1     | 0     |\n| 2          | 0     | 1     |\n\n## Causal Effects & Counterfactuals\n\nHow do we translate \"what if\" questions into a mathematical language?\n\n. . .\n\n::: incremental\n-   Two **potential outcomes**:\n    -   $Y_i(1)$: the outcome for respondent $i$ if they used social media\n    -   $Y_i(0)$: the outcome for respondent $i$ if they did not use social media\n:::\n\n. . .\n\n::: incremental\n-   Causal effect for person $i$: [$Y_i(1) - Y_i(0)$]{.fg style=\"--col: #5d41e6\"}\n    -   $Y_i(1) - Y_i(0) = 0$ $\\rightarrow$ no effect\n    -   $Y_i(1) - Y_i(0) = 1$ $\\rightarrow$ Social media causes happiness\n    -   $Y_i(1) - Y_i(0) = -1$ $\\rightarrow$ Social media causes unhappiness\n:::\n\n## Potential Outcomes\n\n| Respondent | $T_i$ | $Y_i$ | $Y_i(0)$ | $Y_i(1)$ |\n|------------|-------|-------|----------|----------|\n| 1          | 1     | 0     | ?        | 0        |\n| 2          | 0     | 1     | 1        | ?        |\n\n[**Fundamental Problem of Causal Inference**]{.alert}\n\n-   We only observe one of the potential outcomes\n-   Observe $Y_i(1)$ if $T_i=1$ and $Y_i(0)$ if $T_i=0$\n\n## Average Treatment Effects\n\nBecause we cannot observe individual causal effects, we often focus on the **Average Treatment Effect** (ATE):\n\n$$ \\text{ATE} = \\frac{1}{N} \\sum_{i=1}^N (Y_i(1) - Y_i(0)) $$\n\n. . .\n\nThe **ATE** compares the average outcome when everyone is treated to the average outcome when no one is treated.\n\n. . .\n\n**Can we observe the ATE?**\n\n## Comparing Groups\n\nImagine the following dataset:\n\n| Respondent | $T_i$ | $Y_i$ | $Y_i(0)$ | $Y_i(1)$ |\n|------------|-------|-------|----------|----------|\n| 1          | 1     | 0     | ?        | 0        |\n| 2          | 0     | 1     | 1        | ?        |\n| 3          | 1     | 0     | ?        | 0        |\n| 4          | 0     | 1     | 1        | ?        |\n\n. . .\n\nWe might [estimate]{.alert} the ATE from this data by comparing the average **observed** outcome for those who used social media to those who did not:\n\n$$ \\textrm{Difference in Means} =  \\frac{\\sum_{i=1}^N Y_i \\cdot T_i}{ \\sum_{i=1}^N T_i} - \\frac{\\sum_{i=1}^N Y_i \\cdot (1-T_i)}{ \\sum_{i=1}^N 1-T_i} $$\n\nIn our case, the *estimated* ATE would be: [**-1**]{.alert}\n\n## Counfounding\n\nNow imagine we could observe the potential outcomes for each respondent:\n\n| $i$ | $T_i$ | $Y_i$ | $Y_i(0)$                 | $Y_i(1)$                 | $Y_i(1) - Y_i(0)$ |\n|------------|------------|------------|------------|------------|---------------|\n| 1   | 1     | 0     | [0]{style=\"color:blue;\"} | 0                        | 0                 |\n| 2   | 0     | 1     | 1                        | [1]{style=\"color:blue;\"} | 0                 |\n| 3   | 1     | 0     | 0                        | [0]{style=\"color:blue;\"} | 0                 |\n| 4   | 0     | 1     | [1]{style=\"color:blue;\"} | 1                        | 0                 |\n\n. . .\n\nEven though our *estimated* ATE is -1, the true ATE is 0. Why?\n\n. . .\n\nThere is an association between the treatment variable and potential outcomes, but it is not causal.\n\nIn our example, social media users are less happy, but this is not because of social media use $\\rightarrow$ the comparison across groups is *confounded*.\n\n## Randomization {.center}\n\nWe will discuss in more detail later, but key idea is that **random assignment** of a treatment *breaks* the association between treatment and potential outcomes.\n\nThis allows for *unconfounded* comparisons across groups.\n\n## Facebook Cessation Experiment {{< fa brands facebook >}}\n\n@allcottWelfareEffectsSocial2020 presents a randomized experiment where half of around 2,800 Facebook users were paid about \\$100 to deactivate their accounts for a month.\n\nWhat do they find?\n\n. . .\n\nFacebook cessation:\n\n::: incremental\n-   Freed up on average of 60 minutes per day\n-   Led to spending less time online and more time with friends and family\n-   Resulted in 15% decrease in news consumption; also decreased knowledge of politics\n-   Resulted in less extreme political opinions\n-   Caused small improvements in subjective wellbeing\n:::\n\n# R\n\n## R and RStudio\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/r-logo.png){fig-alt=\"R logo\" fig-align=\"center\"}\n\n-   R is an open-source statistical **programming language**\n-   R is also an environment for statistical computing and graphics\n-   It's easily extensible with *packages*\n:::\n\n::: {.column .fragment width=\"50%\"}\n![](images/rstudio-logo.png){fig-alt=\"RStudio logo\"}\n\n-   RStudio is a convenient interface for R called an **IDE** (integrated development environment), e.g. *\"I write R code in the RStudio IDE\"*\n-   RStudio is not a requirement for programming with R, but it's very commonly used by R programmers and data scientists\n:::\n:::\n\n## R vs. RStudio\n\n[![](images/r_vs_rstudio.png){fig-alt=\"On the left: a car engine. On the right: a car dashboard. The engine is labelled R. The dashboard is labelled RStudio.\" fig-align=\"center\" width=\"1001\"}](https://moderndive.com/1-getting-started.html)\n\n::: aside\nSource: [Modern Dive](https://moderndive.com/1-getting-started.html).\n:::\n\n## R packages {.center}\n\n::: incremental\n-   **Packages**: Fundamental units of reproducible R code, including reusable R functions, the documentation that describes how to use them, and sample data.\n\n-   As of 15 January 2023, there are 20,252 R packages available on **CRAN** (the Comprehensive R Archive Network).\n\n-   We're going to work with a small subset of these.\n:::\n\n## Tour recap: R + RStudio\n\n![](images/tour-r-rstudio.png)\n\n## A short list (for now) of R essentials\n\n-   Functions are (most often) verbs, followed by what they will be applied to in parentheses:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndo_this(to_this)\ndo_that(to_this, to_that, with_those)\n```\n:::\n\n\n. . .\n\n-   Packages are installed with the `install.packages()` function and loaded with the `library` function, once per session:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"package_name\")\nlibrary(package_name)\n```\n:::\n\n\n## R essentials (continued)\n\n-   Columns (variables) in data frames are accessed with `$`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataframe$var_name\n```\n:::\n\n\n. . .\n\n-   Object documentation can be accessed with `?`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?mean\n```\n:::\n\n\n## tidyverse\n\n::: columns\n::: {.column width=\"50%\"}\n[![](images/tidyverse.png){fig-alt=\"Hex logos for dplyr, ggplot2, forcats, tibble, readr, stringr, tidyr, and purrr\"}](https://tidyverse.org)\n:::\n\n::: {.column width=\"50%\"}\n[tidyverse.org](https://www.tidyverse.org/)\n\n-   The **tidyverse** is an opinionated collection of R packages designed for data science\n-   All packages share an underlying philosophy and a common grammar\n:::\n:::\n\n# Quarto\n\n## Quarto {.center}\n\n::: incremental\n-   Fully reproducible reports -- each time you render the analysis is ran from the beginning\n-   Code goes in chunks narrative goes outside of chunks\n-   A visual editor for a familiar / Google docs-like editing experience\n:::\n\n## Tour recap: Quarto\n\n![](images/tour-quarto.png){fig-alt=\"RStudio IDE with a Quarto document, source code on the left and output on the right. Annotated to show the YAML, a link, a header, and a code chunk.\" fig-align=\"center\"}\n\n## Environments {.center}\n\n::: callout-important\nThe environment of your Quarto document is separate from the Console!\n:::\n\nRemember this, and expect it to bite you a few times as you're learning to work with Quarto!\n\n## Environments\n\n::: columns\n::: {.column width=\"50%\"}\nFirst, run the following in the console:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- 2\nx * 3\n```\n:::\n\n\n<br>\n\n::: fragment\nAll looks good?\n:::\n:::\n\n::: {.column .fragment width=\"50%\"}\nThen, add the following in an R chunk in your Quarto document\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx * 3\n```\n:::\n\n\n<br>\n\n::: fragment\nWhat happens? Why the error?\n:::\n:::\n:::\n\n## How will we use Quarto?\n\n-   Every class activity, problem set, project, etc. is an Quarto document\n-   You'll always have a template Quarto document to start with\n-   The amount of scaffolding in the template will decrease over the semester\n\n## Awknowledgements {.center}\n\n-   This lecture draws partly from:\n    -   [GOV50](https://gov50-f23.github.io) taught by Matt Blackwell at Harvard University\n    -   [STA 199](https://sta199-s24.github.io) taught by Mine Ã‡etinkaya-Rundel at Duke University.\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}